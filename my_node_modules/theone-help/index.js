'use strict';
/**
 * theone-help
 * theone.io 博客 特属专供 辅助模块
 *//**
 * Module dependencies.
 */

/**
 * Module dependencies.
 * 依赖
 */
var fs = require('fs');
var mkdirp = require('mkdirp');

//自动创建 缺少路径
exports.autoPath = function  (path, cb) {
    fs.readdir(path, function  (err) {
        if(err){
            mkdirp(path,function  (err) {
                if(err){
                    cb(err);
                }
                cb();
            });
        }else{
            cb();
        }
    });
};

/**
 * base64Save2image,对base64字符串形式对图片进行存储
 * @param {string}  rootPath    根目录位于服务器的地址
 * @param  string   imgFullPath 目录地址完整文件名
 * @param  string   base64      base64图片的字符串
 * @param  function cb          回调函数
 */
exports.base64Save2image = function (rootPath, phPath, base64, cb) {
    var imgFullPath = rootPath+'/'+phPath;
    var rbase64 = base64.replace(/^data:image\/jpeg;base64,/, '');
    fs.writeFile(imgFullPath, rbase64, 'base64', function  (err) {
       if(err){
        return cb(err);
       } 
       cb(null, phPath);
    });

};






